Sys.time()
knitr::opts_chunk$set(echo = TRUE)
coverage <- read_csv("../data/KFF/healthcare-coverage.csv",
skip = 2, col_names = TRUE)
library(readr)
coverage <- read_csv("../data/KFF/healthcare-coverage.csv",
skip = 2, col_names = TRUE)
coverage <- read_csv("./data/KFF/healthcare-coverage.csv",
skip = 2, col_names = TRUE)
getwd()
coverage <- read_csv("./data/KFF/healthcare-coverage.csv",
skip = 2, col_names = TRUE)
knitr::opts_chunk$set(echo = TRUE)
unique(coverage$Location)
class(coverage$Location)
class(coverage$year)
class(spending$year)
knitr::opts_chunk$set(echo = TRUE)
knitr::include_graphics("https://aspe.hhs.gov/system/files/images-reports-basic/70441/fig1.jpg")
read_lines(file = "./data/KFF/healthcare-coverage.csv", n_max = 10)
library(tidyverse)
spending <- read_csv("./data/KFF/healthcare-spending.csv",
skip = 2, col_names = TRUE)
spending <- read_csv("./data/KFF/healthcare-spending.csv",
skip = 2, col_names = TRUE,
n_max  = which(spending$Location == "Notes")-1)
tail(spending)
# Read the data using the `rear` package
coverage <- read_csv("./data/KFF/healthcare-coverage.csv",
skip = 2, col_names = TRUE,
n_max  = which(coverage$Location == "Notes")-1)
spending <- read_csv("./data/KFF/healthcare-spending.csv",
skip = 2, col_names = TRUE,
n_max  = which(spending$Location == "Notes")-1)
spending <- read_csv("./data/KFF/healthcare-spending.csv",
skip = 2, col_names = TRUE,
n_max  = which(spending$Location == "Notes")-1)
spending <- read_csv("./data/KFF/healthcare-spending.csv",
skip = 2, col_names = TRUE)
spending <- read_csv("./data/KFF/healthcare-spending.csv",
skip = 2, col_names = TRUE,
n_max  = which(spending$Location == "Notes")-1)
tail(spending)
spending <- read_csv("./data/KFF/healthcare-spending.csv",
skip = 2, col_names = TRUE,
n_max  = which(spending$Location == "Notes")-1)
spending <- read_csv("./data/KFF/healthcare-spending.csv",
skip = 2, col_names = TRUE,
n_max  = which(spending$Location == "Notes")-1)
spending <- read_csv("./data/KFF/healthcare-spending.csv",
skip = 2, col_names = TRUE)
spending <- read_csv("./data/KFF/healthcare-spending.csv",
skip = 2, col_names = TRUE,
n_max  = which(spending$Location == "Notes")-1)
tail(spending)
spending <- read_csv("./data/KFF/healthcare-spending.csv",
skip = 2, col_names = TRUE,
n_max  = which(spending$Location == "Notes")-1)
spending <- read_csv("./data/KFF/healthcare-spending.csv",
skip = 2, col_names = TRUE)
spending <- read_csv("./data/KFF/healthcare-spending.csv",
skip = 2, col_names = TRUE,
n_max  = which(spending$Location == "Notes")-1)
# smallest
hc %>%
group_by(Location) %>%
summarise(avg_spending_capita = mean(spending_capita)) %>%
arrange(avg_spending_capita) %>%
head(n=3)
# Read the data using the `rear` package
coverage <- read_csv("./data/KFF/healthcare-coverage.csv",
skip = 2, col_names = TRUE)
coverage <- read_csv("./data/KFF/healthcare-coverage.csv",
skip = 2, col_names = TRUE,
n_max  = which(coverage$Location == "Notes")-1)
spending <- read_csv("./data/KFF/healthcare-spending.csv",
skip = 2, col_names = TRUE)
spending <- read_csv("./data/KFF/healthcare-spending.csv",
skip = 2, col_names = TRUE,
n_max  = which(spending$Location == "Notes")-1)
# Convert the `coverage` and `spending` datasets from _wide_ to _long_ formats using the `tidyr` R package
coverage <- gather(coverage, "year_type", "tot_coverage", -Location)
spending <- gather(spending, "year", "tot_spending", -Location)
# Wrangle the datasets using some `dplyr` action verbs
coverage <-
coverage %>%
separate(year_type, sep="__", into=c("year", "type"), convert = TRUE) %>%
mutate_at("tot_coverage", as.integer)
spending <-
spending %>%
separate(year, sep="__", into=c("year", "name"), convert = TRUE) %>%
select(-name)
table(coverage$year)
table(spending$year)
hc <- left_join(coverage, spending, by = c("Location", "year"))
head(hc)
tail(hc)
hc <- right_join(coverage, spending, by = c("Location", "year"))
head(hc)
tail(hc)
hc <- inner_join(coverage, spending, by = c("Location", "year"))
head(hc)
tail(hc)
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(readr)
read_lines(file = "./data/KFF/healthcare-coverage.csv", n_max = 10)
coverage[1:5, 1:5]
library(tidyverse)
library(readr)
read_lines(file = "./data/KFF/healthcare-coverage.csv", n_max = 10)
tail(coverage, n=30)
coverage <- read_csv("./data/KFF/healthcare-coverage.csv",
skip = 2, col_names = TRUE)
coverage <- read_csv("./data/KFF/healthcare-coverage.csv",
skip = 2, col_names = TRUE,
n_max  = which(coverage$Location == "Notes")-1)
tail(coverage)
?tibble::tibble
glimpse(coverage)
?tibble::tibble
?tibble::tibble
unique(coverage$Location)
unique(coverage$Location)
unique(coverage$Location)
library(datasets)
data(state)
unique(state.name)
state.abb <- c(state.abb, "DC")
state.region <- as.factor(c(as.character(state.region), "South"))
state.name <- c(state.name, "District of Columbia")
coverage[1:5, 1:5]
library(tidyr)
coverage <- gather(coverage, "year_type", "tot_coverage", -Location)
coverage
coverage %>%
separate(year_type, sep="__",
into=c("year", "type"))
coverage <-
coverage %>%
separate(year_type, sep="__",
into=c("year", "type"),
convert = TRUE)
coverage
coverage <-
coverage %>%
mutate_at("tot_coverage", as.integer)
table(coverage$type, coverage$year)
coverage <- read_csv("./data/KFF/healthcare-coverage.csv",
skip = 2, col_names = TRUE)
head(coverage)
head(coverage)
tail(coverage)
coverage <- read_csv("./data/KFF/healthcare-coverage.csv",
skip = 2, col_names = TRUE)
coverage <- read_csv("./data/KFF/healthcare-coverage.csv",
skip = 2, col_names = TRUE,
n_max  = which(coverage$Location == "Notes")-1)
tail(coverage)
coverage <- gather(coverage, "year_type", "tot_coverage", -Location)
coverage
coverage %>%
separate(year_type, sep="__",
into=c("year", "type"))
coverage <-
coverage %>%
separate(year_type, sep="__",
into=c("year", "type"),
convert = TRUE)
coverage
coverage <-
coverage %>%
mutate_at("tot_coverage", as.integer)
knitr::opts_chunk$set(echo = TRUE)
p <- ggplot()
p <- hc %>%
filter(year==2014) %>%
ggplot()
p <- hc %>%
filter(year==2014) %>%
ggplot(aes(x = spending_capita, y = prop_coverage))
p
```{r, message=FALSE}
library(tidyverse)
knitr::include_graphics("https://rviews.rstudio.com/post/2017-06-09-What-is-the-tidyverse_files/tidyverse1.png")
library(readr)
read_lines(file = "./data/KFF/healthcare-coverage.csv", n_max = 10)
coverage <- read_csv("./data/KFF/healthcare-coverage.csv",
skip = 2, col_names = TRUE)
head(coverage)
tail(coverage)
tail(coverage, n=30)
coverage <- read_csv("./data/KFF/healthcare-coverage.csv",
skip = 2, col_names = TRUE)
coverage <- read_csv("./data/KFF/healthcare-coverage.csv",
skip = 2, col_names = TRUE,
n_max  = which(coverage$Location == "Notes")-1)
tail(coverage)
spending <- read_csv("./data/KFF/healthcare-spending.csv",
skip = 2, col_names = TRUE)
spending <- read_csv("./data/KFF/healthcare-spending.csv",
skip = 2, col_names = TRUE,
n_max  = which(spending$Location == "Notes")-1)
tail(spending)
?tibble::tibble
glimpse(coverage)
unique(coverage$Location)
library(datasets)
data(state)
unique(state.name)
state.abb <- c(state.abb, "DC")
state.region <- as.factor(c(as.character(state.region), "South"))
state.name <- c(state.name, "District of Columbia")
state.abb <- c(state.abb, "DC")
state.region <- as.factor(c(as.character(state.region), "South"))
state.name <- c(state.name, "District of Columbia")
knitr::include_graphics("http://r4ds.had.co.nz/diagrams/data-science.png")
coverage[1:5, 1:5]
library(tidyr)
coverage <- gather(coverage, "year_type", "tot_coverage", -Location)
coverage
spread(coverage, year_type, tot_coverage)
spending <- gather(spending, "year", "tot_spending", -Location)
spending
coverage %>%
separate(year_type, sep="__",
into=c("year", "type"))
coverage <-
coverage %>%
separate(year_type, sep="__",
into=c("year", "type"),
convert = TRUE)
coverage
coverage <-
coverage %>%
mutate_at("tot_coverage", as.integer)
table(coverage$type, coverage$year)
# smallest
hc %>%
group_by(Location) %>%
summarise(avg_spending_capita = mean(spending_capita)) %>%
arrange(avg_spending_capita) %>%
head(n=3)
hc.employer.2013 <- hc %>%
filter(type == "Employer", year == "2013")
hc.employer.2013 <- hc %>%
filter(type == "Employer", year == "2013")
plot(hc.employer.2013$spending_capita,
hc.employer.2013$prop_coverage, log = "xy",
xlab = "spending per capita",
ylab = "proportion of Employer coverage")
knitr::opts_chunk$set(echo = TRUE)
knitr::include_graphics("https://aspe.hhs.gov/system/files/images-reports-basic/70441/fig1.jpg")
knitr::include_graphics("http://r4ds.had.co.nz/images/tidy-1.png")
knitr::include_graphics("http://r4ds.had.co.nz/images/tidy-9.png")
library(tidyverse)
knitr::include_graphics("https://rviews.rstudio.com/post/2017-06-09-What-is-the-tidyverse_files/tidyverse1.png")
library(readr)
read_lines(file = "./data/KFF/healthcare-coverage.csv", n_max = 10)
coverage <- read_csv("./data/KFF/healthcare-coverage.csv",
skip = 2, col_names = TRUE)
head(coverage)
tail(coverage)
tail(coverage, n=30)
coverage <- read_csv("./data/KFF/healthcare-coverage.csv",
skip = 2, col_names = TRUE)
coverage <- read_csv("./data/KFF/healthcare-coverage.csv",
skip = 2, col_names = TRUE,
n_max  = which(coverage$Location == "Notes")-1)
tail(coverage)
spending <- read_csv("./data/KFF/healthcare-spending.csv",
skip = 2, col_names = TRUE)
spending <- read_csv("./data/KFF/healthcare-spending.csv",
skip = 2, col_names = TRUE,
n_max  = which(spending$Location == "Notes")-1)
tail(spending)
glimpse(coverage)
unique(coverage$Location)
library(datasets)
data(state)
unique(state.name)
state.abb <- c(state.abb, "DC")
state.region <- as.factor(c(as.character(state.region), "South"))
state.name <- c(state.name, "District of Columbia")
knitr::include_graphics("http://r4ds.had.co.nz/diagrams/data-science.png")
coverage[1:5, 1:5]
library(tidyr)
coverage <- gather(coverage, "year_type", "tot_coverage", -Location)
coverage
spending <- gather(spending, "year", "tot_spending", -Location)
spending
spread(coverage, year_type, tot_coverage)
coverage %>%
separate(year_type, sep="__",
into=c("year", "type"))
coverage <-
coverage %>%
separate(year_type, sep="__",
into=c("year", "type"),
convert = TRUE)
coverage
coverage <-
coverage %>%
mutate_at("tot_coverage", as.integer)
# Add the abbreviation of States
coverage$abb <- state.abb[match(coverage$Location, state.name)]
coverage$region <- state.region[match(coverage$Location, state.name)]
coverage
# Add the abbreviation of States
coverage$abb <- state.abb[match(coverage$Location, state.name)]
coverage$region <- state.region[match(coverage$Location, state.name)]
coverage
table(coverage$type, coverage$year)
spending
spending <-
spending %>%
separate(year, sep="__", into=c("year", "name"), convert = TRUE) %>%
select(-name)
spending
coverage %>%
select(year:type)
coverage %>%
select(starts_with("t"))
coverage %>%
filter(Location == "Maryland")
coverage %>%
filter(Location == "Maryland",
year > 2014)
coverage %>%
filter(Location == "Maryland",
type == "Uninsured")
coverage %>%
arrange(tot_coverage)
coverage %>%
filter(Location != "United States", year == 2016, type == "Employer") %>%
arrange(desc(tot_coverage)) %>%
head(n=3)
table(coverage$year)
table(spending$year)
?dplyr::join
hc <- left_join(coverage, spending, by = c("Location", "year"))
head(hc)
tail(hc)
hc <- right_join(coverage, spending, by = c("Location", "year"))
head(hc)
tail(hc)
hc <- inner_join(coverage, spending, by = c("Location", "year"))
head(hc)
tail(hc)
hc <- hc %>%
filter(Location != "United States")
table(hc$type)
pop <- hc %>%
filter(type == "Total") %>%
select(Location, year, tot_coverage)
pop
hc <- hc %>%
filter(type != "Total") %>%
left_join(pop, by = c("Location", "year")) %>%
rename(tot_coverage = tot_coverage.x, tot_pop = tot_coverage.y)
hc
table(hc$type)
hc.employer.2013 <- hc %>%
filter(type == "Employer", year == "2013")
plot(hc.employer.2013$tot_spending,
hc.employer.2013$tot_coverage, log = "xy",
xlab = "spending", ylab = "coverage")
par(mfrow=c(1,2))
plot(hc.employer.2013$tot_pop,
hc.employer.2013$tot_coverage, log = "xy",
xlab = "population size", ylab = "coverage")
plot(hc.employer.2013$tot_pop,
hc.employer.2013$tot_spending, log = "xy",
xlab = "population size", ylab = "spending")
hc <- hc %>%
mutate(prop_coverage = tot_coverage/tot_pop)
hc
hc <- hc %>%
mutate(spending_capita = (tot_spending*1e6) / tot_pop)
hc %>% select(prop_coverage, spending_capita)
hc.employer.2013 <- hc %>%
filter(type == "Employer", year == "2013")
plot(hc.employer.2013$spending_capita,
hc.employer.2013$prop_coverage, log = "xy",
xlab = "spending per capita",
ylab = "proportion of Employer coverage")
hc %>%
summarise(avg_spending_capita = mean(spending_capita))
hc %>%
group_by(Location) %>%
summarise(avg_spending_capita = mean(spending_capita))
# smallest
hc %>%
group_by(Location) %>%
summarise(avg_spending_capita = mean(spending_capita)) %>%
arrange(avg_spending_capita) %>%
head(n=3)
# largest
hc %>%
group_by(Location) %>%
summarise(avg_spending_capita = mean(spending_capita)) %>%
arrange(desc(avg_spending_capita)) %>%
head(n=3)
hc %>%
group_by(region) %>%
summarise(avg_spending_capita = mean(spending_capita),
sd_spending_capita = sd(spending_capita))
boxplot(hc$spending_capita ~ hc$region)
p <- ggplot()
p <- hc %>%
filter(year==2014) %>%
ggplot()
p <- hc %>%
filter(year==2014) %>%
ggplot(aes(x = spending_capita, y = prop_coverage))
p
hc.employer.2013 <- hc %>%
filter(type == "Employer", year == "2013")
plot(hc.employer.2013$spending_capita,
hc.employer.2013$prop_coverage,
xlab = "spending per capita",
ylab = "coverage proportion")
p <- hc %>%
filter(type == "Employer", year == "2013") %>%
ggplot(aes(x = spending_capita, y = prop_coverage))
p + geom_point() +
xlab("spending per capita") +
ylab("coverage proportion")
hc %>%
filter(type == "Employer", year == "2013") %>%
ggplot(aes(x = spending_capita, y = prop_coverage)) +
geom_point() +
xlab("spending per capita") +
ylab("coverage proportion")
hc %>%
filter(type == "Employer", year == "2013") %>%
ggplot(aes(x = spending_capita, y = prop_coverage)) +
geom_point() +
xlab("spending per capita") +
ylab("coverage proportion") +
geom_smooth(method = "lm", col = "red")
hc %>%
filter(type == "Employer", year == "2013") %>%
ggplot(aes(x = spending_capita, y = prop_coverage)) +
geom_point() +
xlab("spending per capita") +
ylab("coverage proportion") +
geom_smooth(method = "lm", col = "red") +
geom_text(aes(label=abb), nudge_x = 150)
## add your code here
hc %>%
filter(type == "Employer", year == "2013") %>%
ggplot(aes(x = spending_capita, y = prop_coverage,
color = region)) +
geom_point() +
xlab("spending per capita") +
ylab("coverage proportion") +
geom_smooth(method = "lm", col = "red") +
geom_text(aes(label=abb), nudge_x = 150)
View(hc)
p <- hc %>%
#filter(year == "2014") %>%
ggplot(aes(x = spending_capita, y = life_exp_years,
color = region)) +
geom_point() +
xlab("spending per capita") +
ylab("life expectactancy") +
geom_smooth(method = "lm", col = "red") +
geom_text(aes(label=abb))
p + facet_wrap(year~type, scales="free")
p <- hc %>%
#filter(year == "2013") %>%
ggplot(aes(x = spending_capita, y = prop_coverage,
color = region)) +
geom_point() +
xlab("spending per capita") +
ylab("coverage proportion") +
geom_smooth(method = "lm", col = "red") +
geom_text(aes(label=abb), nudge_x = 150) +
facet_wrap(~type)
p + facet_wrap(year~type, scales="free")
p <- hc %>%
ggplot(aes(x = spending_capita, y = prop_coverage,
color = region)) +
geom_point() +
xlab("spending per capita") +
ylab("coverage proportion") +
geom_smooth(method = "lm", col = "red") +
geom_text(aes(label=abb), nudge_x = 150)
p + facet_wrap(year~type, scales="free")  ## Ask questions here!
p <- hc %>%
ggplot(aes(x = spending_capita, y = prop_coverage,
color = region)) +
geom_point() +
xlab("spending per capita") +
ylab("coverage proportion") +
geom_smooth(method = "lm", col = "red") +
geom_text(aes(label=abb), nudge_x = 150)
p + facet_grid(year~type, scales="free")  ## Ask questions here!
p + facet_grid(year~type)
p + facet_grid(year~type, scales="free")
<img src="https://www.rstudio.com/wp-content/uploads/2015/03/ggplot2-cheatsheet.pdf" align="middle" width="800">
